<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Reparaciones – Blue Home</title>
  <link rel="stylesheet" href="/styles.css">
  <script src="/config.js"></script>
  <script src="/guard.js"></script>
</head>
<body data-role="reparaciones">
  <div class="header">
    <div class="brand">
      <div class="logo">BH</div>
      <div>
        <div class="title">Reparaciones</div>
        <div style="font-size:12px;color:#9aa4b2">Panel</div>
      </div>
    </div>
    <button class="btn" onclick="logout()">Cerrar sesión</button>
  </div>
  <div class="main">
    <div class="card">
      <h2>Panel de Reparaciones</h2>
      <div id="info" class="kv"></div>
      <p style="margin-top:12px">Seguimiento de incidencias y coordinación con técnicos.</p>
    </div>
  </div>
  <div class="footer">© Blue Home Inmobiliaria</div>
  <script>
    const role = document.body.dataset.role;
    const auth = requireRole(role);
    if (auth) {
      const kv = document.getElementById('info');
      const user = auth.user;
      kv.innerHTML = `
        <label>Usuario</label><div>${user.username || auth.payload.sub}</div>
        <label>Rol</label><div>${user.role || auth.payload.role}</div>
        <label>Expira</label><div>${new Date(auth.payload.exp * 1000).toLocaleString()}</div>
        <label>Token (breve)</label><div>${(auth.token || '').slice(0, 16)}…</div>
      `;
    }
  </script>
</body>
</html>
