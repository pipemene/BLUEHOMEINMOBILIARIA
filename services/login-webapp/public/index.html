<!doctype html><html lang="es"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Blue Home – Login</title>
<link rel="stylesheet" href="styles.css"><script src="/config.js"></script></head><body>
<div class="header">
  <div class="brand"><div class="logo">BH</div><div><div class="title">Blue Home</div><div style="font-size:12px;color:#9aa4b2">Gestor – Acceso</div></div></div>
  <a href="/" class="btn" style="background:#1f2937;border:1px solid #263143">Login</a>
</div>
<div class="main">
  <div class="card">
    <h2>Iniciar sesión</h2>
    <form id="f" style="display:grid;gap:10px;max-width:420px">
      <div><label>Usuario</label><br><input id="usuario" style="width:100%;padding:10px;border-radius:8px;border:1px solid #263143;background:#0b1220;color:#e5e7eb"></div>
      <div><label>Contraseña</label><br><input id="password" type="password" style="width:100%;padding:10px;border-radius:8px;border:1px solid #263143;background:#0b1220;color:#e5e7eb"></div>
      <button class="btn" type="submit">Ingresar</button>
      <div id="msg" style="color:#ef4444;min-height:18px"></div>
    </form>
  </div>
</div>
<div class="footer">© Blue Home Inmobiliaria</div>
<script>
const C = window.__CFG__||{};
const form = document.getElementById('f'); const msg = document.getElementById('msg');
form.addEventListener('submit', async (e)=>{
  e.preventDefault(); msg.textContent = 'Validando…';
  const usuario = document.getElementById('usuario').value.trim();
  const password = document.getElementById('password').value;
  try{
    const r = await fetch((C.AUTH_URL||'') + '/auth/login', {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ usuario, password })
    });
    const data = await r.json();
    if(!r.ok || !data.ok) throw new Error(data.error || 'Error de autenticación');
    localStorage.setItem('BH_TOKEN', data.token);
    localStorage.setItem('BH_USER', JSON.stringify(data.user));
    const role = (data.user?.role || '').toLowerCase();
    const target = (C.REDIRECT_MAP||{})[role] || (C.REDIRECT_URL||'/');
    window.location.href = target;
  }catch(err){ msg.textContent = err.message || 'Error'; }
});
</script>
</body></html>
